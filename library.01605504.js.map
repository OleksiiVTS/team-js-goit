{"mappings":"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","sources":["src/js/js-vs/genres-library.js"],"sourcesContent":["import GenreList from '../class/GenreList.js';\nimport { styleModal } from '../js-header/header.js';\nimport { styleEmptyLibrary } from '../js-header/header.js';\n\nconst cl_Genres = new GenreList({\n  selector: '.select',\n  url: '/genre/movie/list',\n  query: 'language=en',\n});\ncl_Genres.getGenreList();\n\n// convert genres\nfunction convertId_to_Name(aGenre) {\n  list = cl_Genres.importFromLS();\n  if (!aGenre) {\n    return;\n  }\n\n  const result = aGenre.map(item => {\n    const obj = list.find(el => el.id === item);\n    return obj ? obj.name : null;\n  });\n\n  return result.join(', ');\n}\n\nconst boxLibraryCinema = document.querySelector('.library');\nlet libraryCinema = JSON.parse(localStorage.getItem('libraryFilms'));\n\nconst select = document.querySelector('.library-filter');\nif (select) {\n  select.addEventListener('input', onLibreryFilter);\n}\n// слухач події клік на селекторі\n// window.addEventListener('click', (event) => {\n//   if ( event.view.location.pathname === '/library.html' ||\n//        event.view.location.pathname === '/team-js-goit/library.html') {\n\n//     return document\n//     .querySelector('.library-filter')\n//     .addEventListener('input', onLibreryFilter);\n//   }\n//   return;\n// });\n\nonMarkup(libraryCinema);\n\n// отримуемо потрібний масив даних для розмітки і виводу на сторінку\nfunction onLibreryFilter(event) {\n  const genre = Number(select.value);\n\n  try {\n    libraryCinema = JSON.parse(localStorage.getItem('libraryFilms'));\n    if (libraryCinema.length === 0) {\n      throw new Error('масив пустий');\n    }\n\n    if (isNaN(genre)) {\n      onMarkup(libraryCinema);\n      return;\n    }\n\n    const filter = libraryCinema.filter(element => {\n      if (element.genres) {\n        return element.genres.some(item => item.id === genre);\n      } else {\n        return element.genre_ids.some(item => item === genre);\n      }\n    });\n\n    onMarkup(filter);\n  } catch (error) {\n    onError(error);\n  }\n}\n\n// створення розмітки\nfunction onMarkup(data) {\n  const cards = createCard(data);\n  update(cards);\n  managerModal();\n  showEmptyLibrary();\n}\n\n// вивід даних на сторінку\nfunction update(data) {\n  if (boxLibraryCinema) {\n    boxLibraryCinema.innerHTML = '';\n    boxLibraryCinema.insertAdjacentHTML('beforeend', data);\n  }\n}\n\n// обгортання елементу масиву хтмл-кодом\nfunction createCard(data) {\n  return data.reduce((acc, item) => {\n    return acc + TemplateMovieCard(item);\n  }, '');\n}\n\n// шаблон\nfunction TemplateMovieCard(data) {\n  const { poster_path, original_title, title, vote_average, release_date, id } =\n    data;\n\n  let aGenres = null;\n  if (data.genres) {\n    aGenres = data.genres\n      .map(e => e.name)\n      .slice(0, 2)\n      .join(', ');\n  } else {\n    aGenres = convertId_to_Name(data.genre_ids.slice(0, 2));\n  }\n  let strGenres = aGenres;\n  if (aGenres.length > 20) {\n    strGenres = aGenres.split(',')[0];\n  }\n\n  return `<a href=\"\" data-id-movie=\"${id ? id : 0}\">\n  <div class=\"movie-card overlay-card\" data-id-movie=\"${id ? id : 0}\">\n      <img class=\"gallery__image\" src=\"${\n        'https://image.tmdb.org/t/p/w400' + poster_path\n      }\" alt=\"${title ? title : original_title}\" loading=\"lazy\"/>\n      <div class=\"gallery__up_image\"></div>\n      <div class=\"catalog_info\">\n        <h2 class=\"catalog_title\">\n        ${title ? title : original_title}\n        </h2>\n          <div class=\"ganres_rating\">\n            <p class=\"catalog_genres\">\n            ${strGenres} | ${release_date.slice(0, 4)}\n            </p>\n            <div class=\"rating\">\n            <div class=\"rating__body\">\n              <div class=\"rating__active\" style=\"width: ${\n                vote_average.toFixed(1) * 10\n              }%;\"></div>\n              <div class=\"rating__items\">\n                <input type=\"radio\" class=\"rating__item\" name=\"rating\" value=\"1\">\n                <input type=\"radio\" class=\"rating__item\" name=\"rating\" value=\"2\">\n                <input type=\"radio\" class=\"rating__item\" name=\"rating\" value=\"3\">\n                <input type=\"radio\" class=\"rating__item\" name=\"rating\" value=\"4\">\n                <input type=\"radio\" class=\"rating__item\" name=\"rating\" value=\"5\">\n              </div>\n            </div>\n          </div>\n          </div>\n      </div>\n      </div>\n      </a>`;\n}\n\n// если пустой список\nfunction emptyLibraryMarkup() {\n  if (libraryCinema.length === 0) {\n    document.querySelector('.library-filter').style.display = 'none';\n\n    return `<div class=\"empty-library\"> \n      <p class=\"empty-library-text\">OOPS...<br/> We are very sorry! <br/> You don’t have any movies in your library.</p>\n      <button type=\"button\" class=\"button-watch-trailer\">\n        <a class=\"hero-href\"  href=\"../src/partials/catalog/catalog-catalog.html\">Search movie</a>\n      </button>\n    </div>`;\n  }\n}\n\nfunction showEmptyLibrary() {\n  if (boxLibraryCinema) {\n    const result = emptyLibraryMarkup();\n    if (result) {\n      boxLibraryCinema.innerHTML = '';\n      boxLibraryCinema.insertAdjacentHTML('beforeend', result);\n      styleEmptyLibrary();\n    }\n  }\n}\n\nfunction onError(error) {\n  console.log(error);\n}\n\n//=======\nfunction createModal(data) {\n  const {\n    title,\n    original_title,\n    poster_path,\n    vote_average,\n    vote_count,\n    popularity,\n    overview,\n    genre_ids,\n  } = data;\n\n  let btn = 'Add to My Library';\n  const libraryFilms = JSON.parse(localStorage.getItem('libraryFilms')) || [];\n\n  for (const film of libraryFilms) {\n    if (film.title === title || film.original_title === title) {\n      btn = 'Remove from My Library';\n    }\n  }\n\n  let aGenres = null;\n  if (data.genres) {\n    aGenres = data.genres\n      .map(e => e.name)\n      .slice(0, 2)\n      .join(', ');\n  } else {\n    aGenres = convertId_to_Name(data.genre_ids.slice(0, 2));\n  }\n  let strGenres = aGenres;\n  if (aGenres.length > 20) {\n    strGenres = aGenres.split(',')[0];\n  }\n\n  const modal = document.getElementById('moreDetails');\n  modal.classList.remove('more-details-is-hidden');\n\n  modal.innerHTML = `\n      <div class=\"more-details-modal\">\n        <div class=\"close-button-box\">\n          <button class=\"more-details-close-button\" id=\"closeDetails\" type=\"button\">X</button>\n        </div>\n        <div class=\"details-wrapper\">\n          <div class=\"more-details-img-box\">\n            <img width=\"380px\" class=\"more-detail-img\" src=\"https://image.tmdb.org/t/p/original/${poster_path}\" alt=\"${title}\" />\n          </div>\n          <div class=\"more-details-info\">\n            <h2 class=\"film-title\">${title ? title : original_title}</h2>\n            <table>\n              <tr>\n                <td class=\"table-row table-column-name\">Vote / Votes:</td>\n                <td><span class=\"vote-average\">${vote_average}</span> / <span class=\"vote-count\">${vote_count}</span></td>\n              </tr>\n              <tr>\n                <td class=\"table-row table-column-name\">Popularity:</td>\n                <td>${popularity}</td>\n              </tr>\n              <tr>\n                <td class=\"table-row table-column-name\">Genre:</td>\n                <td>${strGenres}</td>\n              </tr>\n            </table>\n            <span class=\"description-about\">About:</span>\n            <span class=\"more-details-about\">${overview}</span>\n            <div class=\"more-details-adml-box\">\n              <button id=\"addToLibraryButton\" class=\"button-rem-me\">${btn}</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    `;\n\n  // close modal window\n  const closeBtn = modal.querySelector('#closeDetails');\n  closeBtn.addEventListener('click', () => {\n    document.body.style.overflow = 'visible';\n    modal.classList.add('more-details-is-hidden');\n\n    onLibreryFilter();\n    showEmptyLibrary();\n  });\n\n  const addToLibraryButton = modal.querySelector('#addToLibraryButton');\n  addToLibraryButton.addEventListener('click', () => {\n    addToLibrary(data);\n  });\n}\n\nfunction addToLibrary(film) {\n  try {\n    const addButton = document.getElementById('addToLibraryButton');\n    const libraryFilms = JSON.parse(localStorage.getItem('libraryFilms')) || [];\n\n    const filmTitle = film.title || film.original_title;\n\n    if (addButton.textContent === 'Add to My Library') {\n      addButton.textContent = 'Remove from My Library';\n\n      libraryFilms.push(film);\n      localStorage.setItem('libraryFilms', JSON.stringify(libraryFilms));\n    } else {\n      addButton.textContent = 'Add to My Library';\n\n      const index = libraryFilms.findIndex(\n        filmItem =>\n          filmItem.title === filmTitle || filmItem.original_title === filmTitle\n      );\n      if (index !== -1) {\n        libraryFilms.splice(index, 1);\n        localStorage.setItem('libraryFilms', JSON.stringify(libraryFilms));\n\n        // libraryCinema = JSON.parse(localStorage.getItem('libraryFilms'))\n        // console.log(libraryCinema);\n        // onMarkup(libraryCinema)\n      }\n    }\n  } catch (error) {\n    console.error(error);\n  }\n}\n\nfunction managerModal() {\n  // якщо області виводу не має, значить не та сторінка\n  if (!boxLibraryCinema) {\n    return;\n  }\n\n  const movieCards = boxLibraryCinema.querySelectorAll('.movie-card');\n\n  movieCards.forEach(card => {\n    const movieId = Number(card.dataset.idMovie);\n\n    let list = libraryCinema;\n    if (list.length === 0) {\n      throw Error('Список бібліотеки пустий');\n      return;\n    }\n    const data = list.filter(item => item.id === movieId);\n\n    // console.log(data);\n    if (data.length === 0) {\n      throw Error('у об`єктів повинні бути id');\n      return;\n    }\n    card.addEventListener('click', event => {\n      event.preventDefault();\n      document.body.style.overflow = 'hidden';\n      createModal(data[0]);\n      setTimeout(styleModal, 0);\n    });\n  });\n}\n"],"names":["$2JeuR","parcelRequire","$41d9bd8ee51c5d62$var$cl_Genres","default","selector","url","query","$41d9bd8ee51c5d62$var$convertId_to_Name","aGenre","list","importFromLS","map","item","obj","find","el","id","name","join","getGenreList","$41d9bd8ee51c5d62$var$boxLibraryCinema","document","querySelector","$41d9bd8ee51c5d62$var$libraryCinema","JSON","parse","localStorage","getItem","$41d9bd8ee51c5d62$var$select","$41d9bd8ee51c5d62$var$onLibreryFilter","event","genre","Number","value","length","Error","isNaN","$41d9bd8ee51c5d62$var$onMarkup","filter","element","genres","some","genre_ids","error","console","log","$41d9bd8ee51c5d62$var$onError","data","cards","reduce","acc","poster_path","original_title","title","vote_average","release_date","aGenres","e","slice","strGenres","split","toFixed","$41d9bd8ee51c5d62$var$TemplateMovieCard","$41d9bd8ee51c5d62$var$createCard","innerHTML","insertAdjacentHTML","$41d9bd8ee51c5d62$var$update","querySelectorAll","forEach","card","movieId","dataset","idMovie","addEventListener","preventDefault","body","style","overflow","vote_count","popularity","overview","btn","libraryFilms","film","modal","getElementById","classList","remove","add","$41d9bd8ee51c5d62$var$showEmptyLibrary","addButton","filmTitle","textContent","push","setItem","stringify","index","findIndex","filmItem","splice","$41d9bd8ee51c5d62$var$addToLibrary","$41d9bd8ee51c5d62$var$createModal","setTimeout","$2BK0I","styleModal","$41d9bd8ee51c5d62$var$managerModal","result","display","$41d9bd8ee51c5d62$var$emptyLibraryMarkup","styleEmptyLibrary"],"version":3,"file":"library.01605504.js.map"}