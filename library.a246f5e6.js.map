{"mappings":"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","sources":["src/js/js-vs/genres-library.js"],"sourcesContent":["import GenreList from '../class/GenreList.js';\n\nconst cl_Genres = new GenreList({\n  selector: '.select',\n  url: '/genre/movie/list',\n  query: 'language=en',\n});\ncl_Genres.getGenreList();\n\n// convert genres\nfunction convertId_to_Name(aGenre) {\n  list = cl_Genres.importFromLS();\n  if (!aGenre) { \n    return\n  }\n\n  const result = aGenre.map(item => {\n    const obj = list.find(el => el.id === item);\n    return obj ? obj.name : null;\n  });\n\n  return result.join(', ');\n}\n\nconst boxLibraryCinema = document.querySelector('.library');\nconst libraryCinema = JSON.parse(localStorage.getItem('libraryFilms'));\n\n// слухач події клік на селекторі \nwindow.addEventListener('click', (event) => {\n  if ( event.view.location.pathname === '/library.html' ||\n       event.view.location.pathname === '/team-js-goit/library.html') {\n    return document\n      .querySelector('.library-filter')\n      .addEventListener('input', onLibreryFilter);\n  }\n  return;\n});\nonMarkup(libraryCinema)\n\n// отримуемо потрібний масив даних для розмітки і виводу на сторінку\nfunction onLibreryFilter(event) {\n  const genre = Number(event.currentTarget.value);\n  \n  if (isNaN(genre)){\n    onMarkup(libraryCinema)\n    return\n  }\n\n  // const filter = libraryCinema.filter(element => {\n  //   return element.genres.some(item => item.id === genre);\n\n  const filter = libraryCinema.filter(element => {\n    if (element.genres) {\n      return element.genres.some(item => item.id === genre);\n    } else {\n      return element.genre_ids.some(item => item === genre);\n    }\n  });\n    \n  // console.log(filter);\n  \n  onMarkup(filter);\n}\n\n// створення розмітки\nfunction onMarkup(data){\n  const cards = createCard(data)\n  update(cards)\n  managerModal();\n}\n\n// вивід даних на сторінку\nfunction update(data) {\n  if (boxLibraryCinema) {\n    boxLibraryCinema.innerHTML = '';\n    boxLibraryCinema.insertAdjacentHTML(\"beforeend\", data);\n  }\n}\n\n// обгортання елементу масиву хтмл-кодом\nfunction createCard(data){\n  return data.reduce(\n    (acc, item) => {\n     return acc + TemplateMovieCard(item)\n   }, \"\");\n}\n\n// шаблон\nfunction TemplateMovieCard( data ) {\n  const { \n    poster_path, \n    original_title, \n    title, \n    vote_average, \n    release_date, \n    id\n  } = data;\n\n  \n  let aGenres = null;\n  if (data.genres) { \n    aGenres = data.genres.map(e => e.name).slice(0, 2).join(', ')\n  } else {\n    aGenres = convertId_to_Name(data.genre_ids)\n  }\n\n  return `<a href=\"\" data-id-movie=\"${id ? id: 0}\">\n  <div class=\"movie-card overlay-card\" data-id-movie=\"${id ? id: 0}\">\n      <img class=\"gallery__image\" src=\"${\n        'https://image.tmdb.org/t/p/w400' + poster_path\n      }\" alt=\"${title ? title : original_title}\" loading=\"lazy\"/>\n      <div class=\"gallery__up_image\"></div>\n      <div class=\"catalog_info\">\n        <h2 class=\"catalog_title\">\n        ${title ? title : original_title}\n        </h2>\n          <div class=\"ganres_rating\">\n            <p class=\"catalog_genres\">\n            ${aGenres} | ${release_date.slice(0, 4)}\n            </p>\n            <div class=\"rating\">\n            <div class=\"rating__body\">\n              <div class=\"rating__active\" style=\"width: ${\n                vote_average.toFixed(1) * 10\n              }%;\"></div>\n              <div class=\"rating__items\">\n                <input type=\"radio\" class=\"rating__item\" name=\"rating\" value=\"1\">\n                <input type=\"radio\" class=\"rating__item\" name=\"rating\" value=\"2\">\n                <input type=\"radio\" class=\"rating__item\" name=\"rating\" value=\"3\">\n                <input type=\"radio\" class=\"rating__item\" name=\"rating\" value=\"4\">\n                <input type=\"radio\" class=\"rating__item\" name=\"rating\" value=\"5\">\n              </div>\n            </div>\n          </div>\n          </div>\n      </div>\n      </div>\n      </a>`;\n}\n\n// если пустой список\nfunction emptyLibraryMarkup() {\n  if (libraryCinema.length === 0) {\n    document.querySelector('.library-filter').style.display = 'none';\n\n    return `<div class=\"empty-library\"> \n      <p class=\"empty-library-text\">OOPS...<br/> We are very sorry! <br/> You don’t have any movies in your library.</p>\n      <button type=\"button\" class=\"button-watch-trailer\">\n        <a class=\"hero-href\"  href=\"../src/partials/catalog/catalog-catalog.html\">Search movie</a>\n      </button>\n    </div>`;\n  }\n}\n\nif (boxLibraryCinema) {\n  boxLibraryCinema.insertAdjacentHTML('beforeend', emptyLibraryMarkup());\n}\n\n\n//=======\nfunction createModal(data) {\n    const {\n      title,\n      original_title,\n      poster_path,\n      vote_average,\n      vote_count,\n      popularity,\n      overview,\n      genre_ids,\n    } = data;\n\n    let btn = 'Add to My Library';\n    const libraryFilms = JSON.parse(localStorage.getItem('libraryFilms')) || [];\n\n    for (const film of libraryFilms) {\n      if (film.title === title || film.original_title === title) {\n        btn = 'Remove from My Library';\n      }\n    }\n\n    let aGenres = null;\n    if (data.genres) { \n      aGenres = data.genres.map(e => e.name).slice(0, 2).join(', ')\n    } else {\n      aGenres = convertId_to_Name(data.genre_ids)\n    }\n\n    const modal = document.getElementById('moreDetails');\n    modal.classList.remove('more-details-is-hidden');\n\n    modal.innerHTML = `\n      <div class=\"more-details-modal\">\n        <div class=\"close-button-box\">\n          <button class=\"more-details-close-button\" id=\"closeDetails\" type=\"button\">X</button>\n        </div>\n        <div class=\"details-wrapper\">\n          <div class=\"more-details-img-box\">\n            <img width=\"380px\" class=\"more-detail-img\" src=\"https://image.tmdb.org/t/p/original/${poster_path}\" alt=\"${title}\" />\n          </div>\n          <div class=\"more-details-info\">\n            <h2 class=\"film-title\">${title ? title : original_title}</h2>\n            <table>\n              <tr>\n                <td class=\"table-row table-column-name\">Vote / Votes:</td>\n                <td><span class=\"vote-average\">${vote_average}</span> / <span class=\"vote-count\">${vote_count}</span></td>\n              </tr>\n              <tr>\n                <td class=\"table-row table-column-name\">Popularity:</td>\n                <td>${popularity}</td>\n              </tr>\n              <tr>\n                <td class=\"table-row table-column-name\">Genre:</td>\n                <td>${aGenres}</td>\n              </tr>\n            </table>\n            <span class=\"description-about\">About:</span>\n            <span class=\"more-details-about\">${overview}</span>\n            <div class=\"more-details-adml-box\">\n              <button id=\"addToLibraryButton\" class=\"button-rem-me\">${btn}</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    `;\n\n    const closeBtn = modal.querySelector('#closeDetails');\n    closeBtn.addEventListener('click', () => {\n      document.body.style.overflow = 'visible';\n      modal.classList.add('more-details-is-hidden');\n\n      // onMarkup(libraryCinema)\n    });\n\n    const addToLibraryButton = modal.querySelector('#addToLibraryButton');\n    addToLibraryButton.addEventListener('click', () => {\n      addToLibrary(data);\n    });\n  }\n\n  function addToLibrary(film) {\n    try {\n      const addButton = document.getElementById('addToLibraryButton');\n      const libraryFilms =\n        JSON.parse(localStorage.getItem('libraryFilms')) || [];\n\n      const filmTitle = (film.title || film.original_title);\n\n      if (addButton.textContent === 'Add to My Library') {\n        addButton.textContent = 'Remove from My Library';\n\n        libraryFilms.push(film);\n        localStorage.setItem('libraryFilms', JSON.stringify(libraryFilms));\n      } else {\n        addButton.textContent = 'Add to My Library';\n\n        const index = libraryFilms.findIndex(\n          filmItem => filmItem.title === filmTitle || filmItem.original_title === filmTitle\n        );\n        if (index !== -1) {\n          libraryFilms.splice(index, 1);\n          localStorage.setItem('libraryFilms', JSON.stringify(libraryFilms));\n\n          // libraryCinema = JSON.parse(localStorage.getItem('libraryFilms'))\n          // console.log(libraryCinema);\n          // onMarkup(libraryCinema)\n        }\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  function managerModal() {\n    // якщо області виводу не має, значить не та сторінка\n    if (!boxLibraryCinema) {\n      return;\n    }\n\n    const movieCards = boxLibraryCinema.querySelectorAll('.movie-card');\n\n    movieCards.forEach(card => {\n      const movieId = Number(card.dataset.idMovie);\n\n      let list = libraryCinema;\n      if (list.length === 0) { \n        throw Error(\"Список бібліотеки пустий\")\n        return\n      }\n      const data = list.filter(item => item.id === movieId);\n\n      // console.log(data);\n      if (data.length === 0) {\n        throw Error('у об`єктів повинні бути id')\n        return\n      }\n      card.addEventListener('click', event => {\n        event.preventDefault();\n        document.body.style.overflow = 'hidden';\n        createModal(data[0]);\n      });\n    });\n  }"],"names":["$41d9bd8ee51c5d62$var$cl_Genres","parcelRequire","default","selector","url","query","$41d9bd8ee51c5d62$var$convertId_to_Name","aGenre","list","importFromLS","map","item","obj","find","el","id","name","join","getGenreList","$41d9bd8ee51c5d62$var$boxLibraryCinema","document","querySelector","$41d9bd8ee51c5d62$var$libraryCinema","JSON","parse","localStorage","getItem","$41d9bd8ee51c5d62$var$onLibreryFilter","event","genre","Number","currentTarget","value","isNaN","$41d9bd8ee51c5d62$var$onMarkup","filter","element","genres","some","genre_ids","data","cards","reduce","acc","poster_path","original_title","title","vote_average","release_date","aGenres","e","slice","toFixed","$41d9bd8ee51c5d62$var$TemplateMovieCard","$41d9bd8ee51c5d62$var$createCard","innerHTML","insertAdjacentHTML","$41d9bd8ee51c5d62$var$update","querySelectorAll","forEach","card","movieId","dataset","idMovie","length","Error","addEventListener","preventDefault","body","style","overflow","vote_count","popularity","overview","btn","libraryFilms","film","modal","getElementById","classList","remove","add","addButton","filmTitle","textContent","push","setItem","stringify","index","findIndex","filmItem","splice","error","console","$41d9bd8ee51c5d62$var$addToLibrary","$41d9bd8ee51c5d62$var$createModal","$41d9bd8ee51c5d62$var$managerModal","window","view","location","pathname","display","$41d9bd8ee51c5d62$var$emptyLibraryMarkup"],"version":3,"file":"library.a246f5e6.js.map"}